"use strict";(self.webpackChunkkfeoch02=self.webpackChunkkfeoch02||[]).push([[376],{7376:(m,p,r)=>{r.d(p,{V:()=>B});var a=r(4006),h=r(1135),s=r(8746),c=r(262),n=r(8505),l=r(4004),d=r(2340),f=r(5035),g=r(4650),L=r(529),v=r(7009);let B=(()=>{class u{constructor(t,e,i){this.http=t,this.languageService=e,this.snackBar=i,this.creditBankURL=d.N.apiUrl+"CreditBank/",this.paymentURL=d.N.apiUrl+"Payment/",this.isGettingCrtificate=new h.X(!1),this.isLoading=new h.X(!1),this.isOfficesTransactionsLoading$=new h.X(!1),this.officesTransactionsSize=new h.X(0),this.isLoadingPayments=new h.X(!1),this.currentLanguage=this.languageService.currentLanguage,this.blockedAuthTransactionsSize=new h.X(0)}createCastingSupervisionTransactionForm(t){return new a.cw({OfficeId:new a.NI(t.OfficeId,a.kI.required),CitizenCivilNumber:new a.NI(t.CitizenCivilNumber??"",{updateOn:"change",validators:[a.kI.required,a.kI.minLength(12),a.kI.maxLength(12)]})})}fetchCastingSupervisionTransactionForm(t){return new a.cw({CivilNumber:new a.NI({value:t.CivilNumber??"",disabled:!0}),FinancialNumber:new a.NI({value:t.FinancialNumber??"",disabled:!0}),AgentName:new a.NI({value:t.AgentName??"",disabled:!0}),AreaName:new a.NI({value:t.AreaName??"",disabled:!0}),SectorNumber:new a.NI({value:t.SectorNumber??"",disabled:!0}),PlotNumber:new a.NI({value:t.PlotNumber??"",disabled:!0}),PropertyNumber:new a.NI({value:t.PropertyNumber??"",disabled:!0}),CurrentStage:new a.NI({value:t.CurrentStage??"",disabled:!0}),BuildingType:new a.NI({value:t.BuildingType??"",disabled:!0}),TransactionLicenseNo:new a.NI({value:t.TransactionLicenseNo??"",disabled:!0}),PropertyArea:new a.NI({value:t.PropertyArea??"",disabled:!0}),CurrentStageCode:new a.NI({value:t.CurrentStageCode??"",disabled:!0}),CurrentStageMapped:new a.NI({value:"",disabled:!0})})}getBuildingStages(t){return this.isLoading.next(!0),this.http.get(`${this.creditBankURL}GetBuildingStages/${t}`).pipe((0,s.x)(()=>{this.isLoading.next(!1)}))}fetchTransactionInfoFromCB(t){return this.isLoading.next(!0),this.http.get(this.creditBankURL+`FetchCBTransaction/${t.OfficeId}/${t.CitizenCivilNumber}`).pipe((0,c.K)(e=>{throw e.error&&this.snackBar.open("en"===this.currentLanguage?e.error.message:e.error.messageArabic,this.languageService.translate("Dismiss"),{duration:4e3}),e}),(0,s.x)(()=>{this.isLoading.next(!1)}))}fetchTransactionInfoFromKFEOCH(t){return this.isLoading.next(!0),this.http.get(this.creditBankURL+"GetCBTransaction/"+t).pipe((0,c.K)(e=>{throw e.error&&this.snackBar.open("en"===this.currentLanguage?e.error.message:e.error.messageArabic,this.languageService.translate("Dismiss"),{duration:4e3}),e}),(0,s.x)(()=>{this.isLoading.next(!1)}))}fetchTransactionTerminationInfoFromKFEOCH(t){return this.isLoading.next(!0),this.http.get(this.creditBankURL+"GetCBTransactionTermination/"+t).pipe((0,s.x)(()=>{this.isLoading.next(!1)}))}getCBCertificateById(t){return this.isGettingCrtificate.next(!0),this.http.get(this.creditBankURL+"GetCBCertificate/"+t).pipe((0,s.x)(()=>this.isGettingCrtificate.next(!1)))}addCBTransaction(t){return this.isLoading.next(!0),this.http.post(this.creditBankURL+"AddCBTransaction",t).pipe((0,n.b)(()=>this.snackBar.open(this.languageService.translate("Transaction Inserted"),this.languageService.translate("Dismiss"),{duration:4e3})),(0,c.K)(e=>{throw e.error&&this.snackBar.open("en"===this.currentLanguage?e.error.message:e.error.messageArabic,this.languageService.translate("Dismiss"),{duration:4e3}),e}),(0,s.x)(()=>this.isLoading.next(!1)))}requestTransactionStepAuth(t){return this.isLoading.next(!0),this.http.post(this.creditBankURL+"RequestTransactionAuth",t).pipe((0,n.b)(()=>this.snackBar.open(this.languageService.translate("Hawyti Authentication Requested"),this.languageService.translate("Dismiss"),{duration:4e3})),(0,s.x)(()=>this.isLoading.next(!1)))}checkTransactionAuthStatus(t){return this.http.get(this.creditBankURL+`CheckTransactionAuthStatus/${t}`).pipe((0,n.b)(e=>{this.snackBar.open(this.languageService.translate("Hawyti Authentication Checked!"),this.languageService.translate("Dismiss"),{duration:4e3})}))}moveCBTransaction(t){return this.isLoading.next(!0),this.http.post(this.creditBankURL+"MoveCBTransaction",t).pipe((0,n.b)(()=>this.snackBar.open(this.languageService.translate("Transaction Moved"),this.languageService.translate("Dismiss"),{duration:4e3})),(0,s.x)(()=>this.isLoading.next(!1)))}terminateCBTransaction(t){return this.isLoading.next(!0),this.http.post(this.creditBankURL+"TerminateCBTransaction",t).pipe((0,n.b)(()=>this.snackBar.open(this.languageService.translate("Transaction Terminated"),this.languageService.translate("Dismiss"),{duration:4e3})),(0,s.x)(()=>this.isLoading.next(!1)))}archiveCBTransaction(t,e){return this.isLoading.next(!0),this.http.put(`${this.creditBankURL}ArchiveCBTransaction/${t}/${e}`,{}).pipe((0,n.b)(()=>this.snackBar.open(this.languageService.translate("Transaction Archived"),this.languageService.translate("Dismiss"),{duration:4e3})),(0,c.K)(i=>{throw i.error&&this.snackBar.open("en"===this.currentLanguage?i.error.Message:i.error.MessageArabic,this.languageService.translate("Dismiss"),{duration:4e3}),i}),(0,s.x)(()=>this.isLoading.next(!1)))}unarchiveCBTransaction(t,e){return this.isLoading.next(!0),this.http.put(`${this.creditBankURL}UnarchiveCBTransaction/${t}/${e}`,{}).pipe((0,n.b)(()=>this.snackBar.open(this.languageService.translate("Transaction Unarchived"),this.languageService.translate("Dismiss"),{duration:4e3})),(0,c.K)(i=>{throw i.error&&this.snackBar.open("en"===this.currentLanguage?i.error.Message:i.error.MessageArabic,this.languageService.translate("Dismiss"),{duration:4e3}),i}),(0,s.x)(()=>this.isLoading.next(!1)))}unblockAuth(t){return this.isLoading.next(!0),this.http.patch(this.creditBankURL+"UnblockAuth/"+t,{}).pipe((0,n.b)(()=>this.snackBar.open(this.languageService.translate("Auth Unblocked"),this.languageService.translate("Dismiss"),{duration:4e3})),(0,s.x)(()=>this.isLoading.next(!1)))}postCBCertificateKpay(t){this.isLoadingPayments.next(!0);const e=window.location.origin+window.location.pathname;return t.ReturnUrl=e.replace(/:/g,"_").replace(/\//g,","),this.http.post(this.creditBankURL+"TransactionCertificate",t).pipe((0,s.x)(()=>this.isLoadingPayments.next(!1)))}postCBCompletionCertificateKpay(t){this.isLoadingPayments.next(!0);const e=window.location.origin+window.location.pathname;return t.ReturnUrl=e.replace(/:/g,"_").replace(/\//g,","),this.http.post(this.creditBankURL+"TransactionCompletionCertificate",t).pipe((0,s.x)(()=>this.isLoadingPayments.next(!1)))}generateFreeCertificate(t){return this.isLoadingPayments.next(!0),this.http.post(this.paymentURL+"request-cb-certificate-free-feb",t).pipe((0,n.b)(()=>this.snackBar.open(this.languageService.translate("Certificate has been generated"),this.languageService.translate("Dismiss"),{duration:4e3})),(0,c.K)(e=>{throw e.error&&this.snackBar.open("en"===this.currentLanguage?e.error.Message:e.error.MessageArabic,this.languageService.translate("Dismiss"),{duration:4e3}),e}),(0,s.x)(()=>this.isLoadingPayments.next(!1)))}updateTransactionSelectedStage(t,e){return this.isLoading.next(!0),this.http.put(this.creditBankURL+"TransactionSelectedStage/"+t,e).pipe((0,n.b)(()=>this.snackBar.open(this.languageService.translate("Transaction Updated"),this.languageService.translate("Dismiss"),{duration:4e3})),(0,c.K)(i=>{throw i.error&&this.snackBar.open("en"===this.currentLanguage?i.error.Message:i.error.MessageArabic,this.languageService.translate("Dismiss"),{duration:4e3}),i}),(0,s.x)(()=>{this.isLoading.next(!1)}))}updateTransactionTerminationStep(t,e){return this.isLoading.next(!0),this.http.put(this.creditBankURL+"TransactionTerminationStep/"+t,e).pipe((0,n.b)(()=>this.snackBar.open(this.languageService.translate("Transaction Updated"),this.languageService.translate("Dismiss"),{duration:4e3})),(0,s.x)(()=>{this.isLoading.next(!1)}))}putTransactionStage(t,e){return this.isLoading.next(!0),this.http.put(this.creditBankURL+"TransactionStage/"+t,e).pipe((0,n.b)(()=>this.snackBar.open(this.languageService.translate("Transaction Updated"),this.languageService.translate("Dismiss"),{duration:4e3})),(0,s.x)(()=>{this.isLoading.next(!1)}))}sendStageFilesToCB(t,e){return this.isLoading.next(!0),this.http.put(this.creditBankURL+"sendStageFilesToCB/"+t,e).pipe((0,n.b)(()=>this.snackBar.open(this.languageService.translate("Already Sent to Kuwaiti Credit Bank"),this.languageService.translate("Dismiss"),{duration:4e3})),(0,c.K)(i=>{throw i.error&&this.snackBar.open("en"===this.currentLanguage?i.error.message:i.error.messageArabic,this.languageService.translate("Dismiss"),{duration:4e3}),i}),(0,s.x)(()=>{this.isLoading.next(!1)}))}createMembershipRenewForm(t,e){return new a.cw({OfficeId:new a.NI(t,a.kI.required),CertificateEntityId:new a.NI("",a.kI.required),RequestTypeId:new a.NI("",a.kI.required),RequestTypeAmount:new a.NI(e?.Amount),Lang:new a.NI(this.currentLanguage),ReturnUrl:new a.NI("")})}getAllOfficeTransactions(t){return this.isLoading.next(!0),this.http.get(this.creditBankURL+"getAllOfficeTransactions/"+t).pipe((0,s.x)(()=>{this.isLoading.next(!1)}))}getAllOfficeTerminationTransactions(t){return this.isLoading.next(!0),this.http.get(this.creditBankURL+"getAllOfficeTerminationTransactions/"+t).pipe((0,s.x)(()=>{this.isLoading.next(!1)}))}getAllOfficeCBCertificates(t){return this.isLoading.next(!0),this.http.get(this.creditBankURL+"getAllOfficeCBCertificates/"+t).pipe((0,s.x)(()=>{this.isLoading.next(!1)}))}getBlockedAuthTransactions(t){return this.isOfficesTransactionsLoading$.next(!0),this.http.post(this.creditBankURL+"getBlockedAuthTransactions",t).pipe((0,n.b)(e=>{this.blockedAuthTransactionsSize.value!==e.DataSize&&this.blockedAuthTransactionsSize.next(e.DataSize)}),(0,l.U)(e=>e.Data),(0,s.x)(()=>{this.isOfficesTransactionsLoading$.next(!1)}))}getOfficesTransactionsByFilter(t,e=!1){return this.isOfficesTransactionsLoading$.next(!0),this.http.post(`${this.creditBankURL}filter?completed=${e}`,t).pipe((0,n.b)(i=>{this.officesTransactionsSize.value!==i.DataSize&&this.officesTransactionsSize.next(i.DataSize)}),(0,l.U)(i=>i.Data),(0,s.x)(()=>this.isOfficesTransactionsLoading$.next(!1)))}get blockedAuthTransactionsSize$(){return this.blockedAuthTransactionsSize.asObservable()}get isLoading$(){return this.isLoading.asObservable()}get isOfficesTransactionsLoading(){return this.isOfficesTransactionsLoading$.asObservable()}get officesTransactionsSize$(){return this.officesTransactionsSize.asObservable()}get isGettingCertificate$(){return this.isGettingCrtificate.asObservable()}get isLoadingPayments$(){return this.isLoadingPayments.asObservable()}updateCertificatesStatus(t){return this.isLoading.next(!0),this.http.put(`${this.creditBankURL}UpdateCertificatesStatus/${t}`,{}).pipe((0,n.b)(()=>this.snackBar.open(this.languageService.translate("Certificates Status Updated"),this.languageService.translate("Dismiss"),{duration:4e3})),(0,c.K)(e=>{throw e.error&&this.snackBar.open("en"===this.currentLanguage?e.error.Message:e.error.MessageArabic,this.languageService.translate("Dismiss"),{duration:4e3}),e}),(0,s.x)(()=>{this.isLoading.next(!1)}))}}return u.\u0275fac=function(t){return new(t||u)(g.LFG(L.eN),g.LFG(f.Z),g.LFG(v.ux))},u.\u0275prov=g.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()}}]);