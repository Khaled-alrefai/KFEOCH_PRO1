"use strict";(self.webpackChunkkfeoch02=self.webpackChunkkfeoch02||[]).push([[47],{47:(H,L,a)=>{a.r(L),a.d(L,{AdminReportsModule:()=>Y});var l=a(6895),p=a(9116),R=a(5035),e=a(4650),v=a(9777),T=a(445),g=a(3267),f=a(7392),c=a(6338),y=a(3238),Z=a(3683),A=a(4859),h=a(9383);function C(t,r){1&t&&(e.TgZ(0,"mat-icon"),e._uU(1,"chevron_left"),e.qZA())}function O(t,r){1&t&&(e.TgZ(0,"mat-icon"),e._uU(1,"chevron_right"),e.qZA())}let U=(()=>{class t{constructor(n,i){this.deviceService=n,this.languageService=i,this.isHandset=this.deviceService.isHandset$,this.dir=this.languageService.currentDirection$}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(v.U),e.Y36(R.Z))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-admin-reports-nav"]],decls:22,vars:11,consts:[[1,"office-side-nav2",3,"dir"],[3,"opened","mode"],["drawer",""],["translate",""],["mat-list-item","","routerLink","main","routerLinkActive","office-home-active",3,"click"],["mat-list-icon","",1,"material-symbols-outlined"],["mat-line","","mat-h3","","translate",""],["mat-line","","translate",""],["mat-icon-button","","color","primary",1,"float-drawer-toggle",3,"click"],[4,"ngIf"]],template:function(n,i){if(1&n){const o=e.EpF();e.TgZ(0,"mat-sidenav-container",0),e.ALo(1,"async"),e.TgZ(2,"mat-sidenav",1,2),e.ALo(4,"async"),e.ALo(5,"async"),e.TgZ(6,"mat-toolbar")(7,"span",3),e._uU(8,"Reports"),e.qZA()(),e.TgZ(9,"mat-action-list")(10,"button",4),e.NdJ("click",function(){e.CHM(o);const u=e.MAs(3);return e.KtG("over"===u.mode&&u.close())}),e.TgZ(11,"span",5),e._uU(12,"table"),e.qZA(),e.TgZ(13,"h3",6),e._uU(14,"Main Reports"),e.qZA(),e.TgZ(15,"p",7),e._uU(16," Export main reports "),e.qZA()()()(),e.TgZ(17,"mat-sidenav-content")(18,"button",8),e.NdJ("click",function(){e.CHM(o);const u=e.MAs(3);return e.KtG(u.toggle())}),e.YNc(19,C,2,0,"mat-icon",9),e.YNc(20,O,2,0,"mat-icon",9),e.qZA(),e._UZ(21,"router-outlet"),e.qZA()()}if(2&n){const o=e.MAs(3);e.Q6J("dir","ltr"===e.lcZ(1,5,i.dir)?"ltr":"rtl"),e.xp6(2),e.Q6J("opened",!e.lcZ(4,7,i.isHandset)||"false")("mode",e.lcZ(5,9,i.isHandset)?"over":"side"),e.xp6(17),e.Q6J("ngIf",o.opened),e.xp6(1),e.Q6J("ngIf",!o.opened)}},dependencies:[l.O5,p.lC,p.rH,p.Od,T.Lv,g.JX,g.TM,g.Rh,f.Hw,c.i$,c.Tg,y.X2,c.Nh,Z.Ye,A.lW,h.Pi,l.Ov]}),t})();var d=a(1135),m=a(8746),w=a(2340),S=a(529);let M=(()=>{class t{constructor(n){this.http=n,this.url=w.N.apiUrl+"report/",this.isLoadingOffices=new d.X(!1),this.isLoadingOwners=new d.X(!1),this.isLoadingSpecialities=new d.X(!1),this.isLoadingContacts=new d.X(!1),this.isLoadingLicenses=new d.X(!1)}getOfficesReport(){return this.isLoadingOffices.next(!0),this.http.get(this.url+"offices",{responseType:"blob"}).pipe((0,m.x)(()=>this.isLoadingOffices.next(!1)))}getOwnersReport(){return this.isLoadingOwners.next(!0),this.http.get(this.url+"owners",{responseType:"blob"}).pipe((0,m.x)(()=>this.isLoadingOwners.next(!1)))}getSpecialitiesReport(){return this.isLoadingSpecialities.next(!0),this.http.get(this.url+"specialities",{responseType:"blob"}).pipe((0,m.x)(()=>this.isLoadingSpecialities.next(!1)))}getContactsReport(){return this.isLoadingContacts.next(!0),this.http.get(this.url+"contacts",{responseType:"blob"}).pipe((0,m.x)(()=>this.isLoadingContacts.next(!1)))}getLicensesReport(){return this.isLoadingLicenses.next(!0),this.http.get(this.url+"licenses",{responseType:"blob"}).pipe((0,m.x)(()=>this.isLoadingLicenses.next(!1)))}get isLoadingOffices$(){return this.isLoadingOffices.asObservable()}get isLoadingOwners$(){return this.isLoadingOwners.asObservable()}get isLoadingSpecialities$(){return this.isLoadingSpecialities.asObservable()}get isLoadingContacts$(){return this.isLoadingContacts.asObservable()}get isLoadingLicenses$(){return this.isLoadingLicenses.asObservable()}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(S.eN))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var x=a(4850),b=a(1572);function $(t,r){1&t&&e._UZ(0,"mat-spinner",9)}function J(t,r){1&t&&e._UZ(0,"mat-spinner",9)}function N(t,r){1&t&&e._UZ(0,"mat-spinner",9)}function _(t,r){1&t&&e._UZ(0,"mat-spinner",9)}function k(t,r){1&t&&e._UZ(0,"mat-spinner",9)}const Q=[{path:"",component:U,children:[{path:"",pathMatch:"full",redirectTo:"main"},{path:"main",component:(()=>{class t{constructor(n,i){this.deviceService=n,this.reportService=i,this.isHandset=this.deviceService.isHandset$,this.isLoadingOffices$=this.reportService.isLoadingOffices$,this.isLoadingOwners$=this.reportService.isLoadingOwners$,this.isLoadingSpecialities$=this.reportService.isLoadingSpecialities$,this.isLoadingContacts$=this.reportService.isLoadingContacts$,this.isLoadingLicenses$=this.reportService.isLoadingLicenses$}ngOnInit(){}getOffices(){this.reportService.getOfficesReport().subscribe(n=>{let i=n.type,o=[];o.push(n);let s=document.createElement("a");s.href=window.URL.createObjectURL(new Blob(o,{type:i})),s.setAttribute("download","AllOffices.xlsx"),document.body.appendChild(s),s.click()})}getOwners(){this.reportService.getOwnersReport().subscribe(n=>{let i=n.type,o=[];o.push(n);let s=document.createElement("a");s.href=window.URL.createObjectURL(new Blob(o,{type:i})),s.setAttribute("download","AllOwners.xlsx"),document.body.appendChild(s),s.click()})}getSpecialities(){this.reportService.getSpecialitiesReport().subscribe(n=>{let i=n.type,o=[];o.push(n);let s=document.createElement("a");s.href=window.URL.createObjectURL(new Blob(o,{type:i})),s.setAttribute("download","AllSpecialities.xlsx"),document.body.appendChild(s),s.click()})}getContacts(){this.reportService.getContactsReport().subscribe(n=>{let i=n.type,o=[];o.push(n);let s=document.createElement("a");s.href=window.URL.createObjectURL(new Blob(o,{type:i})),s.setAttribute("download","AllContacts.xlsx"),document.body.appendChild(s),s.click()})}getLicenses(){this.reportService.getLicensesReport().subscribe(n=>{let i=n.type,o=[];o.push(n);let s=document.createElement("a");s.href=window.URL.createObjectURL(new Blob(o,{type:i})),s.setAttribute("download","AllLicenses.xlsx"),document.body.appendChild(s),s.click()})}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(v.U),e.Y36(M))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-main-reports"]],decls:58,vars:33,consts:[[1,"office-home-content",3,"ngClass"],["translate","",1,"mat-h1"],["translate","",1,"mat-h3"],["translate","",1,"no-margin"],["mat-list-item","",3,"disabled","click"],["mat-list-icon",""],["translate",""],[1,"full-spacer"],["diameter","30",4,"ngIf"],["diameter","30"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0),e.ALo(1,"async"),e.TgZ(2,"h1",1),e._uU(3," Main Reports "),e.qZA(),e.TgZ(4,"h3",2),e._uU(5," Export main reports "),e.qZA(),e.TgZ(6,"p",3),e._uU(7," Click on report to download "),e.qZA(),e.TgZ(8,"mat-action-list")(9,"button",4),e.NdJ("click",function(){return i.getOffices()}),e.ALo(10,"async"),e.TgZ(11,"mat-icon",5),e._uU(12,"apartment"),e.qZA(),e.TgZ(13,"span",6),e._uU(14,"Export all Offices Main Data"),e.qZA(),e._UZ(15,"span",7),e.YNc(16,$,1,0,"mat-spinner",8),e.ALo(17,"async"),e.qZA(),e._UZ(18,"mat-divider"),e.TgZ(19,"button",4),e.NdJ("click",function(){return i.getOwners()}),e.ALo(20,"async"),e.TgZ(21,"mat-icon",5),e._uU(22,"group"),e.qZA(),e.TgZ(23,"span",6),e._uU(24,"Export all Offices Owners"),e.qZA(),e._UZ(25,"span",7),e.YNc(26,J,1,0,"mat-spinner",8),e.ALo(27,"async"),e.qZA(),e._UZ(28,"mat-divider"),e.TgZ(29,"button",4),e.NdJ("click",function(){return i.getSpecialities()}),e.ALo(30,"async"),e.TgZ(31,"mat-icon",5),e._uU(32,"card_membership"),e.qZA(),e.TgZ(33,"span",6),e._uU(34,"Export all Office Specialities"),e.qZA(),e._UZ(35,"span",7),e.YNc(36,N,1,0,"mat-spinner",8),e.ALo(37,"async"),e.qZA(),e._UZ(38,"mat-divider"),e.TgZ(39,"button",4),e.NdJ("click",function(){return i.getContacts()}),e.ALo(40,"async"),e.TgZ(41,"mat-icon",5),e._uU(42,"phone"),e.qZA(),e.TgZ(43,"span",6),e._uU(44,"Export all Offices Contats"),e.qZA(),e._UZ(45,"span",7),e.YNc(46,_,1,0,"mat-spinner",8),e.ALo(47,"async"),e.qZA(),e._UZ(48,"mat-divider"),e.TgZ(49,"button",4),e.NdJ("click",function(){return i.getLicenses()}),e.ALo(50,"async"),e.TgZ(51,"mat-icon",5),e._uU(52,"published_with_changes"),e.qZA(),e.TgZ(53,"span",6),e._uU(54,"Export all Offices Licenses"),e.qZA(),e._UZ(55,"span",7),e.YNc(56,k,1,0,"mat-spinner",8),e.ALo(57,"async"),e.qZA()()()),2&n&&(e.Q6J("ngClass",e.lcZ(1,11,i.isHandset)?"office-home-content-handset":""),e.xp6(9),e.Q6J("disabled",e.lcZ(10,13,i.isLoadingOffices$)),e.xp6(7),e.Q6J("ngIf",e.lcZ(17,15,i.isLoadingOffices$)),e.xp6(3),e.Q6J("disabled",e.lcZ(20,17,i.isLoadingOwners$)),e.xp6(7),e.Q6J("ngIf",e.lcZ(27,19,i.isLoadingOwners$)),e.xp6(3),e.Q6J("disabled",e.lcZ(30,21,i.isLoadingSpecialities$)),e.xp6(7),e.Q6J("ngIf",e.lcZ(37,23,i.isLoadingSpecialities$)),e.xp6(3),e.Q6J("disabled",e.lcZ(40,25,i.isLoadingContacts$)),e.xp6(7),e.Q6J("ngIf",e.lcZ(47,27,i.isLoadingContacts$)),e.xp6(3),e.Q6J("disabled",e.lcZ(50,29,i.isLoadingLicenses$)),e.xp6(7),e.Q6J("ngIf",e.lcZ(57,31,i.isLoadingLicenses$)))},dependencies:[l.mk,l.O5,f.Hw,c.i$,c.Tg,c.Nh,x.d,b.Ou,h.Pi,l.Ov]}),t})()}]}];let E=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[p.Bz.forChild(Q),p.Bz]}),t})(),Y=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[l.ez,E,g.SJ,f.Ps,c.ie,Z.g0,A.ot,b.Cq,h.aw]}),t})()}}]);